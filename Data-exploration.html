<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Diabetes</title>

<script src="site_libs/header-attrs-2.16/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Data-exploration.html">Exploratory statistics</a>
</li>
<li>
  <a href="StatisticaL-Analysis.html">Descriptive statistics</a>
</li>
<li>
  <a href="https://zchunyu.shinyapps.io/predictor/">Diabetes Predictor</a>
</li>
<li>
  <a href="project_report.html">Project Report</a>
</li>
<li>
  <a href="https://youtu.be/iG7VMp0-PUs">
    <span class="fa fa-video fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/Tristaaazjy/jz3571_project.github.io">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Diabetes</h1>

</div>


<div id="data-process-and-cleaning" class="section level2">
<h2>Data Process and Cleaning</h2>
<pre class="r"><code>diabetes &lt;- read.csv(&quot;diabetes.csv&quot;)</code></pre>
<p>We use one dataset drawn from Kaggel which is originally from the
National Institute of Diabetes and Digestive and Kidney. Our dataset
includes 768 observations for 9 varibles, which are shown in table
1.</p>
<p>The objective of this dataset is to predict diabetes diagnostically,
based on the medical measurements in the data. This dataset contains
eight independent medical predictors which might be associated with
diabetes occurrence and one dependent variable <code>outcome</code>. The
data source is female patients at least 21 years old of Pima Indian
heritage..</p>
<p>For the step of data cleaning, we use the read.csv function to load
the raw data, reduce the outline data for all eight measurements, and
reorganize the variables name. There are no null values, so no action
was done to fill the dataset. We convert <code>outcome</code> to factor
data type for future analysis.</p>
<pre class="r"><code>kable(head(dplyr::select(diabetes,Pregnancies,Glucose,BloodPressure,SkinThickness,Insulin, BMI,DiabetesPedigreeFunction,Age, Outcome),9),caption = &quot;Table 1: Raw Data&quot;) %&gt;%
  kable_styling(latex_option = c(&quot;hold_position&quot;), position = &quot;left&quot;)</code></pre>
<table class="table" style>
<caption>
Table 1: Raw Data
</caption>
<thead>
<tr>
<th style="text-align:right;">
Pregnancies
</th>
<th style="text-align:right;">
Glucose
</th>
<th style="text-align:right;">
BloodPressure
</th>
<th style="text-align:right;">
SkinThickness
</th>
<th style="text-align:right;">
Insulin
</th>
<th style="text-align:right;">
BMI
</th>
<th style="text-align:right;">
DiabetesPedigreeFunction
</th>
<th style="text-align:right;">
Age
</th>
<th style="text-align:right;">
Outcome
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
148
</td>
<td style="text-align:right;">
72
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
33.6
</td>
<td style="text-align:right;">
0.627
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
26.6
</td>
<td style="text-align:right;">
0.351
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
183
</td>
<td style="text-align:right;">
64
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
23.3
</td>
<td style="text-align:right;">
0.672
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
89
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
94
</td>
<td style="text-align:right;">
28.1
</td>
<td style="text-align:right;">
0.167
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
137
</td>
<td style="text-align:right;">
40
</td>
<td style="text-align:right;">
35
</td>
<td style="text-align:right;">
168
</td>
<td style="text-align:right;">
43.1
</td>
<td style="text-align:right;">
2.288
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
116
</td>
<td style="text-align:right;">
74
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
25.6
</td>
<td style="text-align:right;">
0.201
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
78
</td>
<td style="text-align:right;">
50
</td>
<td style="text-align:right;">
32
</td>
<td style="text-align:right;">
88
</td>
<td style="text-align:right;">
31.0
</td>
<td style="text-align:right;">
0.248
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
1
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
115
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
0
</td>
<td style="text-align:right;">
35.3
</td>
<td style="text-align:right;">
0.134
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
0
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
197
</td>
<td style="text-align:right;">
70
</td>
<td style="text-align:right;">
45
</td>
<td style="text-align:right;">
543
</td>
<td style="text-align:right;">
30.5
</td>
<td style="text-align:right;">
0.158
</td>
<td style="text-align:right;">
53
</td>
<td style="text-align:right;">
1
</td>
</tr>
</tbody>
</table>
<pre class="r"><code>diabetes$Outcome &lt;-factor(diabetes$Outcome)</code></pre>
<p>Table 2 gives the preview about each variable’s intended
measurement.</p>
<pre class="r"><code>variable_name &lt;- c(&quot;Pregnancies&quot;,&quot;Glucose&quot;,&quot;BloodPressure&quot;,&quot;SkinThickness&quot;,&quot;Insulin&quot;, &quot;BMI&quot;,&quot;DiabetesPedigreeFunction&quot;,&quot;Age&quot;, &quot;Outcome&quot;)
description &lt;- c(&quot;To express the Number of pregnancies&quot;,&quot;To express the Glucose level in blood&quot;,&quot;To express the Blood pressure measurement&quot;,&quot;To express the thickness of the skin&quot;,&quot;To express the Insulin level in blood&quot;,&quot;To express the Body mass index&quot;,&quot;To express the Diabetes percentage&quot;,&quot;To express the age&quot;,&quot;To express the diabetes outcome 1 is Yes and 0 is No&quot;)
variable_data &lt;- data.frame(variable_name,description)
kable(variable_data,caption = &quot;Table 2: Data Dictionary&quot;,col.names = c(&quot;Variable Name&quot;,&quot;Description&quot;))%&gt;% kable_styling(latex_option = c(&quot;hold_position&quot;), position = &quot;left&quot;)</code></pre>
<table class="table" style>
<caption>
Table 2: Data Dictionary
</caption>
<thead>
<tr>
<th style="text-align:left;">
Variable Name
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Pregnancies
</td>
<td style="text-align:left;">
To express the Number of pregnancies
</td>
</tr>
<tr>
<td style="text-align:left;">
Glucose
</td>
<td style="text-align:left;">
To express the Glucose level in blood
</td>
</tr>
<tr>
<td style="text-align:left;">
BloodPressure
</td>
<td style="text-align:left;">
To express the Blood pressure measurement
</td>
</tr>
<tr>
<td style="text-align:left;">
SkinThickness
</td>
<td style="text-align:left;">
To express the thickness of the skin
</td>
</tr>
<tr>
<td style="text-align:left;">
Insulin
</td>
<td style="text-align:left;">
To express the Insulin level in blood
</td>
</tr>
<tr>
<td style="text-align:left;">
BMI
</td>
<td style="text-align:left;">
To express the Body mass index
</td>
</tr>
<tr>
<td style="text-align:left;">
DiabetesPedigreeFunction
</td>
<td style="text-align:left;">
To express the Diabetes percentage
</td>
</tr>
<tr>
<td style="text-align:left;">
Age
</td>
<td style="text-align:left;">
To express the age
</td>
</tr>
<tr>
<td style="text-align:left;">
Outcome
</td>
<td style="text-align:left;">
To express the diabetes outcome 1 is Yes and 0 is No
</td>
</tr>
</tbody>
</table>
<ul>
<li>The variable diabetes pedigree function indicates the function which
scores likelihood of diabetes based on family history.</li>
</ul>
</div>
<div id="factors-preview" class="section level2">
<h2>Factors Preview</h2>
<p>We start with identifying whether the eight diagnostic measurements
are related with diabetes or not. Since our outcome variable is a binary
variable, the box plot were used to visualize the relationship between
factors and diabetes. The y-axis was defined as the diagnostic
measurement result and x-axis were grouped by female with diabetes or
not. The results of all box plots are shown in Figure 1.</p>
<pre class="r"><code>p1 &lt;- ggplot(diabetes,aes(x= Outcome, y=Pregnancies,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p2 &lt;- ggplot(diabetes,aes(x= Outcome, y=Glucose,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p3 &lt;- ggplot(diabetes,aes(x= Outcome, y=BloodPressure,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p4 &lt;- ggplot(diabetes,aes(x= Outcome, y=SkinThickness,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p5 &lt;- ggplot(diabetes,aes(x= Outcome, y=Insulin,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p6 &lt;- ggplot(diabetes,aes(x= Outcome, y=BMI,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p7 &lt;- ggplot(diabetes,aes(x= Outcome, y=DiabetesPedigreeFunction,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()

p8 &lt;- ggplot(diabetes,aes(x= Outcome, y=Age,color=Outcome)) + geom_boxplot()+labs(x=&quot;&quot;)+scale_color_manual(labels = c(&quot;Normal&quot;, &quot;Diabetes&quot;), values = c(&quot;#DC9FB4&quot;, &quot;mediumpurple&quot;))+theme(axis.title.y = element_text(size=8))+
  theme_minimal()</code></pre>
<p><img src="Data-exploration_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Results reveal that different groups of females have different
medians of diagnostic results, which indicate that the factors have
linear or nonlinear association with diabetes.</p>
<p>The below Figure 2 shows the histogram plots for each factor to
visualize if these variables follow normal distribution and whether
their measurement value falls in normal range .</p>
<pre class="r"><code>h1 &lt;- ggplot(diabetes, aes(x=Pregnancies)) + 
  geom_histogram( colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;Pregnancies&quot;)

h2 &lt;- ggplot(diabetes, aes(x=Glucose)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;Glucose&quot;)+
  geom_vline(aes(xintercept=70),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)+
  geom_vline(aes(xintercept=100),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)

h3 &lt;- ggplot(diabetes, aes(x=BloodPressure)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;Blood Pressure&quot;)+
  geom_vline(aes(xintercept=120),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)

h4 &lt;- ggplot(diabetes, aes(x=SkinThickness)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+
  labs(x=&quot;Skin Thickness&quot;)+
   geom_vline(aes(xintercept=3.4),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)+
  geom_vline(aes(xintercept=25.2),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)

h5 &lt;- ggplot(diabetes, aes(x=Insulin)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;Insulin&quot;)+
  geom_vline(aes(xintercept=174),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)

h6 &lt;- ggplot(diabetes, aes(x=BMI)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;BMI&quot;)+
   geom_vline(aes(xintercept=18.5),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)+
  geom_vline(aes(xintercept=30),
            color=&quot;blue&quot;, linetype=&quot;dashed&quot;, size=0.8)

h7 &lt;- ggplot(diabetes, aes(x=DiabetesPedigreeFunction)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;DPF&quot;)

h8 &lt;- ggplot(diabetes, aes(x=Age)) + 
  geom_histogram(colour=&quot;mediumslateblue&quot;, fill=&quot;white&quot;)+labs(x=&quot;Age&quot;)</code></pre>
<pre class="r"><code>h &lt;- ggpubr::ggarrange(h1, h2,h3,h4,h5,h6,h7,h8, ncol=4,nrow = 2,common.legend = TRUE)

ggpubr::annotate_figure(h, top = ggpubr::text_grob(&quot;Figure 2: Distributions of Variables&quot;, color = &quot;darkgrey&quot;,face = &quot;bold&quot;, size = 13))</code></pre>
<p><img src="Data-exploration_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>The dash line indicates the normal range for individual females
without diabetes.</p>
<ul>
<li>Glucose: between 4.0 to 5.4 mmol/L(77 to 99 mg/dl) when fasting; Up
to 7.8mmol/L (140 mg/dl) 2 hours after eating.</li>
<li>Blood Pressure &lt;120mm Hg</li>
<li>Skin thickness: 3.40 mm to 25.20 mm in females</li>
<li>BMI: 18.5-24.9</li>
</ul>
<p>We see a large number of the observations have above normal glucose
level, which is expected because our data contains 268 positive diabetes
cases and pregnant females whose glucose level is usually higher.
Because we plan to fit a logistic regression model on the predictors
that doesn’t require a normal distribution of the variables, we don’t
need to transform or remedy our data. The skewness can be neglected.</p>
</div>
<div id="collinearity-test" class="section level2">
<h2>Collinearity test</h2>
<p>Before fitting the model, the collinearity between different factors
needed to be tested. We used the corrplot function to test the
collinearity. The plot result shows that there no significant
correlation relationship between all eight variables, although the
<code>SkinThickness</code> variable and <code>Insulin</code> variable
has a light purple color which indicate they might correlated, the index
is only about 0.6 which is not significantly correlated and also we do
not include the SkinThickness variable in the final model which will be
discussed later. Thus, we can conclude that all the eight variables can
be used to fit a model and find the prediction rate of diabetes.</p>
<pre class="r"><code>col &lt;- colorRampPalette(c(&quot;violetred&quot;, &quot;white&quot;, &quot;mediumpurple2&quot;))(20)
corrplot(res, type = &quot;upper&quot;, order = &quot;hclust&quot;, 
         tl.col = &quot;lavenderblush4&quot;, tl.srt = 40,bg = &quot;lavenderblush2&quot;,col =col,tl.cex = 0.6)</code></pre>
<p><img src="Data-exploration_files/figure-html/unnamed-chunk-11-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="two-specific-factors-exploration" class="section level2">
<h2>Two specific factors exploration</h2>
<p>Since the age and pregnancy factors are most concerned. We use the
bar plot to visualize the proportion of diabetes among stratified age
groups and different numbers of pregnancies.</p>
<div id="age" class="section level3">
<h3>Age</h3>
<p>“Men generally have heart disease in their 40’s and 50’s, about a
decade before women. But this is generally not true for diabetic women.
For diabetic women, the cardiovascular risk occurs earlier. Diabetes
takes away much of the protection premenopausal women would normally get
from estrogen.” —Kapur, A., &amp; Seshiah, V. (2017)</p>
<p>The diabetes proportion gets higher with the increase of age
variable, and the age group of 50-60 years old has the highest diabetes
proportion. Generally, age factors have a positive association with
diabetes proportion.</p>
<pre class="r"><code>diabetes &lt;- diabetes %&gt;% 
  mutate(Agegroup = case_when(Age &lt; 30 ~ &quot;20+&quot;, 
                              30 &lt;= Age &amp; Age &lt; 40 ~ &quot;30+&quot;, 
                              40 &lt;= Age &amp; Age &lt; 50 ~ &quot;40+&quot;, 
                              50 &lt;= Age &amp; Age &lt; 60 ~ &quot;50+&quot;, 
                              60 &lt;= Age ~ &quot;60+&quot;
                               ))

df &lt;- group_by(diabetes,Agegroup) %&gt;%mutate(percent = sum(Outcome)/n())
df &lt;- data.frame(
  Agegroup=c(&quot;20+&quot;,&quot;30+&quot;,&quot;40+&quot;,&quot;50+&quot;,&quot;60+&quot;),
  Percentage= 100*c(0.212,0.461,0.551,0.596,0.281)
  )
ggplot(df, aes(x=Agegroup, y=Percentage)) + 
  geom_bar(stat = &quot;identity&quot;,color=&quot;rosybrown&quot;, fill=&quot;rosybrown&quot; )+
  geom_text(aes(label = round(Percentage,1)), vjust = -0.2, size = 4,
            position = position_dodge(0.9),color =&quot;rosybrown3&quot;) + ggtitle(&quot;Fig3. Percentage of Diabetes in Different Age Groups&quot;)+
  theme_minimal()+labs(x=&quot;Age Group&quot;)+
  theme(plot.title = element_text(color = &quot;darkgrey&quot;,size = 12))</code></pre>
<p><img src="Data-exploration_files/figure-html/unnamed-chunk-12-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="pregnancy" class="section level3">
<h3>Pregnancy</h3>
<p>We also examine the association between pregnancy and diabetes
proportion, as it can be seen in the plot below, as the pregnancy
frequency increases the diabetes proportion also increases, and when the
pregnancy frequency is 17 times, diabetes proportion reaches a hundred
percent.</p>
<pre class="r"><code>df &lt;- group_by(diabetes,Pregnancies) %&gt;%mutate(percent = sum(Outcome)/n())
df &lt;- data.frame(
  Pregnancies=c(0:15,17),
  Percentage= 100*c(0.342,0.215,0.184,0.36,0.338,0.368,0.32,0.556,0.579,0.643,0.417,0.636,0.444,0.5,1.0,1.0,1.0)
  )
ggplot(df, aes(x=Pregnancies, y=Percentage)) + 
  geom_bar(stat = &quot;identity&quot;,color=&quot;rosybrown&quot;, fill=&quot;rosybrown3&quot;)+
  geom_text(aes(label = round(Percentage,1)), vjust = -0.2, size = 3,
            position = position_dodge(0.9),colour = &quot;rosybrown4&quot;) + ggtitle(&quot;Fig4. Percentage of Diabetes According to Different Pregnancies&quot;)+
  theme_minimal()+
  theme(plot.title = element_text(color = &quot;darkgrey&quot;,size = 12))</code></pre>
<p><img src="Data-exploration_files/figure-html/unnamed-chunk-13-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
